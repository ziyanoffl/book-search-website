<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Search</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: rgb(255, 235, 218);
        }

        .card {
            width: 18rem;
        }

        .title {
            text-align: center;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 class="mt-4 title">Book Search</h1>
        <div class="row">
            <div class="mb-3 d-flex justify-content-center align-items-center mx-auto w-50 input-group">
                <input type="text" id="bookName" class="form-control" placeholder="Enter Book Name">
                <button onclick="searchBooks()" class="btn btn-primary">Search</button>
            </div>
            <div id="results" class="row row-cols-1 row-cols-md-2 row-cols-lg-3"></div>
        </div>
    </div>

    <script>
        function searchBooks() {
            const bookName = document.getElementById('bookName').value;
            const apiUrl = `https://openlibrary.org/search.json?q=${bookName}`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => displayResults(data.docs))
                .catch(error => console.error('Error:', error));
        }

        function displayResults(books) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            books.slice(0, 5).forEach(book => {
                const title = book.title;
                const author = book.author_name ? book.author_name[0] : 'Unknown';
                const coverUrl = `https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg`;

                const bookElement = document.createElement('div');
                bookElement.classList.add('col');

                const cardElement = document.createElement('div');
                cardElement.classList.add('card');

                const imageElement = document.createElement('img');
                imageElement.src = coverUrl;
                imageElement.classList.add('card-img-top');

                const cardBodyElement = document.createElement('div');
                cardBodyElement.classList.add('card-body');

                const titleElement = document.createElement('h5');
                titleElement.classList.add('card-title');
                titleElement.textContent = title;

                const authorElement = document.createElement('p');
                authorElement.classList.add('card-text');
                authorElement.textContent = `Author: ${author}`;

                cardBodyElement.appendChild(titleElement);
                cardBodyElement.appendChild(authorElement);
                cardElement.appendChild(imageElement);
                cardElement.appendChild(cardBodyElement);
                bookElement.appendChild(cardElement);

                resultsDiv.appendChild(bookElement);
            });

            if (books.length > 5) {
                const paginationElement = document.createElement('div');
                paginationElement.classList.add('mt-3', 'text-center');

                const buttonElement = document.createElement('button');
                buttonElement.classList.add('btn', 'btn-primary');
                buttonElement.textContent = 'Load More';
                buttonElement.addEventListener('click', loadMoreBooks);

                paginationElement.appendChild(buttonElement);
                resultsDiv.appendChild(paginationElement);
            }
        }

        function loadMoreBooks() {
            const bookName = document.getElementById('bookName').value;
            const apiUrl = `https://openlibrary.org/search.json?q=${bookName}`;
        
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const start = document.getElementById('results').children.length - 1; // Get the current number of books displayed
                    const newBooks = data.docs.slice(start, start + 5);
        
                    displayResults(newBooks);
                })
                .catch(error => console.error('Error:', error));
        }        

    </script>
</body>

</html>